<!DOCTYPE HTML>

<html>
	<head>
		<title>CNN - Détection du cancer</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
	</head>
	<body class="is-preload">

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">
							
							
							<header id="header">
									<a href="index.html" class="logo"><strong>Accueil</strong></a>
									<ul class="icons">
										<li><a href="https://www.linkedin.com/in/hugo-fromont/" class="icon brands fa-linkedin"><span class="label">Linkedin</span></a></li>
										<li><a href="https://github.com/HugoFromont" class="icon brands fa-github"><span class="label">Github</span></a></li>
									</ul>
								</header>

							



							<!-- Content -->
								
									
										
									
<section>
<h1>Classification d'image</h1>
									<span class="image main"><img src="images/CNN_cancer.png" alt="" /></span>
									
																	


						

<p>Nous allons essayer de créer un Résau convolutif à partir du jeu d'images ["Histopathologic-cancer-detection"]("https://www.kaggle.com/c/histopathologic-cancer-detection") disponible sur kaggle. le réseau de convolution à été créé sur un kerel Kaggle.</p>
<hr class="major" />

<h2 id="importationdeslibrairies">Importation des librairies</h2>

<pre><code class="{python} language-{python}">import numpy as np
from pandas import read_csv
import matplotlib.pyplot as plt
import glob
from PIL import Image
import os

#Afficher liste des dossiers
print(os.listdir("../input/"))
</code></pre>

<p><img src = "https://user-images.githubusercontent.com/44996564/54014125-db726180-417b-11e9-9613-e060a8b08fb9.png"></p>

<p>Dans un premier temps, nous allons importer le fichier CSV contenant l'identifiant des images et le label.</p>

<pre><code class="{python} language-{python}">test = read_csv("../input/train_labels.csv")

test = np.array(test)
id = test[:,0]
targets = test[:,1]

print(id[:5])
print(targets[:5])
</code></pre>

<p><img src = "https://user-images.githubusercontent.com/44996564/54014137-e4633300-417b-11e9-84a8-6eebe435009f.png"></p>

<p>Puis nous allons parcourir le vecteur des identifiants pour importer les images une à une dans un vecteur features.</p>

<pre><code class="{python} language-{python}">files = os.listdir("../input/train")

features = []

for i in range(0,len(id)):
    features.append(np.array(Image.open("../input/train/" + id[i] + ".tif").resize((75, 75))))

features = np.array(features)

print("Taille des features :",features.shape)
print("Taille des targets :",targets.shape)
</code></pre>

<p><img src="https://user-images.githubusercontent.com/44996564/54014862-37d68080-417e-11e9-94ff-1727063506ac.png"></p>

<p>Visulaisation d'un échantillon d'images</p>

<pre><code class="{python} language-{python}">index = np.arange(len(features))
np.random.shuffle(index)
features = features[index]

fig = plt.figure(figsize=(17,17))
plt.gcf().subplots_adjust( wspace = 0, hspace = 0.2)
for i in range(1,26):
    plt.subplot(5, 5, i)
    img = plt.imshow(features[i])
    img.axes.get_xaxis().set_visible(False)
    img.axes.get_yaxis().set_visible(False)
    if targets[i]==1:
        label = "Cancer"
    else:
        label = "Sain"
    plt.title((label))
plt.show()
</code></pre>

<p><img src = "https://user-images.githubusercontent.com/44996564/54014229-402dbc00-417c-11e9-91b1-12176196a9b5.png"></p>

<p>Nous allons maintenant partitionner nos données en 2 échantillons (Apprentissage et Test)</p>

<pre><code class="{python} language-{python}">from sklearn.model_selection import train_test_split

x_train, x_valid, y_train, y_valid = train_test_split(features, targets, test_size=0.1, random_state=123)

print("x_train =",x_train.shape,"  |  y_train =",y_train.shape)
print("x_valid =",x_valid.shape,"  |  y_valid =",y_valid.shape)
</code></pre>

<p><img src="https://user-images.githubusercontent.com/44996564/54014881-4ae95080-417e-11e9-901e-1dd1c5632945.png"></p>

<h2 id="crationdunpremiermodleconvolutif">Création d'un premier modèle convolutif</h2>

<p>Nous allons créer notre mdèle convolutif avec la librairie Keras.</p>

<pre><code class="{python} language-{python}">from keras.models import Sequential
from keras.layers import Conv2D, MaxPooling2D, Dropout, Flatten, Dense, Activation, BatchNormalization

model = Sequential()

model.add(Conv2D(32, (8, 8), activation='relu', input_shape=(75, 75, 3)))
model.add(BatchNormalization())
model.add(MaxPooling2D(pool_size=(2, 2)))
model.add(Dropout(0.25))

model.add(Conv2D(64, (5, 5), activation='relu'))
model.add(BatchNormalization())
model.add(MaxPooling2D(pool_size=(2, 2)))
model.add(Dropout(0.25))

model.add(Conv2D(128, (5, 5), activation='relu'))
model.add(BatchNormalization())
model.add(MaxPooling2D(pool_size=(2, 2)))
model.add(Dropout(0.25))

model.add(Conv2D(256, (3, 3), activation='relu'))
model.add(BatchNormalization())
model.add(MaxPooling2D(pool_size=(2, 2)))
model.add(Dropout(0.25))

model.add(Flatten())
model.add(Dense(512, activation='relu'))
model.add(BatchNormalization())
model.add(Dropout(0.5))
model.add(Dense(1, activation='sigmoid'))

model.compile(loss='binary_crossentropy', optimizer='rmsprop', metrics=['accuracy'])

model.summary()
</code></pre>

<p><img src=""></p>

<p>Entraînement du modèle</p>

<pre><code class="{python} language-{python}">model.fit(x=x_train,
          y=y_train,
          batch_size=200,
          epochs=3,
          verbose=1,
          callbacks=None,
          validation_data=(x_valid,y_valid),
          shuffle=True)
</code></pre>

<p><img src=""></p>

<p>Vérification des performances
(Travail en cours ...)</p>
																	
																	
									
									
									
									
								</section>	
									
									
									
									
									
									
									



						</div>
					</div>

				<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">

							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
										<li>
											<span class="opener">Pyhton</span>
											<ul>
												<li><a href="Python_collecte.html">Collecte des données</a></li>
												<li><a href="Python_manipulation.html">Manipuation de données</a></li>
												<li><a href="Python_visualisation.html">Visualisation</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">R</span>
											<ul>
												<li><a href="R_collecte.html">Collecte des données</a></li>
												<li><a href="R_manipulation.html">Manipuation de données</a></li>
												<li><a href="R_visualisation.html">Visualisation</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Projet Python</span>
											<ul>
												<li><a href="CNN_chien_chat.html">CNN - Classification chiens chats </a></li>
												<li><a href="CNN_MNIST.html">CNN - MNIST </a></li>
												<li><a href="#">NLP - Election présidentielle</a></li>
												<li><a href="CNN_Cancer_detection.html">CNN - Detection du cancer </a></li>
											</ul>
										</li>
									</ul>
								</nav>

							<!-- Section -->
								<section>
									<header class="major">
										<h2>Contact</h2>
									</header>
									<ul class="contact">
										<li class="icon solid fa-envelope"><a href="#">hugo.fromont35@gmail.com</a></li>
										<li class="icon brands fa-linkedin"><a href="https://www.linkedin.com/in/hugo-fromont/">Linkedin</a></li>
										<li class="icon brands fa-github"><a href="https://github.com/HugoFromont">Github</a></li>
									</ul>
								</section>
								
							<!-- Footer -->
								<footer id="footer">
									<p class="copyright">&copy; Untitled. All rights reserved. Demo Images: <a href="https://unsplash.com">Unsplash</a>. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
								</footer>


						</div>
					</div>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>