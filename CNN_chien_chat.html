<!DOCTYPE HTML>

<html>
	<head>
		<!-- Google Tag Manager -->
		<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-PNJTS2L');</script>
		<!-- End Google Tag Manager -->
		
	
		<title>Accueil</title>
		<meta charset="utf-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1, user-scalable=no" />
		<link rel="stylesheet" href="assets/css/main.css" />
		
		<!-- Global site tag (gtag.js) - Google Analytics -->
		<script async src="https://www.googletagmanager.com/gtag/js?id=UA-154786126-1"></script>
		<script>
		  window.dataLayer = window.dataLayer || [];
		  function gtag(){dataLayer.push(arguments);}
		  gtag('js', new Date());
		  gtag('config', 'UA-154786126-1');
		</script>
		

	</head>
	<body class="is-preload">
		<!-- Google Tag Manager (noscript) -->
		<noscript><iframe src="https://www.googletagmanager.com/ns.html?id=GTM-PNJTS2L"
		height="0" width="0" style="display:none;visibility:hidden"></iframe></noscript>
		<!-- End Google Tag Manager (noscript) -->

		<!-- Wrapper -->
			<div id="wrapper">

				<!-- Main -->
					<div id="main">
						<div class="inner">
							
							
							<header id="header">
									<a href="index.html" class="logo"><strong>Accueil</strong></a>
									<ul class="icons">
										<li><a href="https://www.linkedin.com/in/hugo-fromont/" class="icon brands fa-linkedin"><span class="label">Linkedin</span></a></li>
										<li><a href="https://github.com/HugoFromont" class="icon brands fa-github"><span class="label">Github</span></a></li>
									</ul>
								</header>
							



							<!-- Content -->
								
								
<section>
<h1>Classification d'image</h1>
									<span class="image main"><img src="images/article_chien_chat.jpg" alt="" /></span>
									
									<p>Nous allons créer un réseau convolutif à partir du jeu d'images <a href="https://www.kaggle.com/c/dogs-vs-cats">Dogs vs. Cats</a> disponible sur kaggle. L'objectif est d'identifier si l'image comporte un chien ou un chat.</p>
									<hr class="major" />
									
									<h3>Importation des librairies</h3>
									<pre><code class="{python} language-{python}">import numpy as np<br/>import os<br/>from PIL import Image<br/>import matplotlib.pyplot as plt</code></pre>

									<h3>Importation des données</h3>
									<p>Dans un premier temps, nous allons établir la connection avec notre espace de stockage google drive. Cela nous permettera de télécharger le fichier zip puis de le déziper.</p>
									<pre><code class="{python} language-{python}">from google.colab import drive<br/>drive.mount('/content/gdrive')<br/><br/>root_path = '/content/gdrive/My Drive/data_google_colab/Dogs_vs_Cats/'<br/># Déziper le jeu d'entrainement<br/>!unzip '/content/gdrive/My Drive/data_google_colab/Dogs_vs_Cats/train.zip'<br/><br/>files = os.listdir("/content/train/")</code></pre>
									<p>Nous importons l'ensemble des images et leur label dans un vecteur.</p>
									<pre><code class="{python} language-{python}">features = []<br/>targets = []<br/><br/>for file in files:<br/>    features.append(np.array(Image.open("/content/train/" + file).resize((75, 75))))<br/>    target = 1 if "cat" in file else 0<br/>    targets.append(target)<br/><br/>features = np.array(features)<br/>targets = np.array(targets)<br/><br/>print("features :", features.shape)<br/>print("targets : ", targets.shape)</code></pre>
									<p><img src = "images/CNN_chien_chat_shape.JPG"></p>									

									<h3>Echantillonnage</h3>
									<p>Echantillonnage des données avec un taux d'apprentissage de 10%</p>
									<pre><code class="{python} language-{python}">from sklearn.model_selection import train_test_split<br/><br/>x_train, x_valid, y_train, y_valid = train_test_split(features, targets, test_size=0.1, random_state=123)<br/><br/>print("x_train =",x_train.shape,"  |  y_train =",y_train.shape)<br/>print("x_valid =",x_valid.shape,"  |  y_valid =",y_valid.shape)</code></pre>
									<p><img src = "images/CNN_chien_chat_ech_shape.JPG"></p>
									
									<h3">Visualisation d'un échantillon d'images</h3>
									<pre><code class="{python} language-{python}">index = np.arange(len(x_train))<br/>np.random.shuffle(index)<br/>x_train = x_train[index]<br/>y_train = y_train[index]<br/><br/>fig = plt.figure(figsize=(17,17))<br/>plt.gcf().subplots_adjust( wspace = 0, hspace = 0.2)<br/>for i in range(1,26):<br/>    plt.subplot(5, 5, i)<br/>    img = plt.imshow(features[i])<br/>    img.axes.get_xaxis().set_visible(False)<br/>    img.axes.get_yaxis().set_visible(False)<br/>    if targets[i] == 0:<br/>        label = "Chien"<br/>    else:<br/>        label = "Chat"<br/>    plt.title((label))<br/>plt.show()</code></pre>
									<p><img src = "images/CNN_chien_chat_visu.png"></p>

									<h3>Création du modèle</h3>
									<p>Pour créer notre modèle convolutif, nous nous sommes inspirés du modèle VGG16 en ajoutant de la Batch normalisation, Nous n'avons pas utilisé de modèle pré-entraîné dans cet exemple.</p>
									<pre><code class="{python} language-{python}">from keras.models import Sequential<br/>from keras.layers import Conv2D, MaxPooling2D, Dropout, Flatten, Dense, Activation, BatchNormalization<br/>from keras import optimizers<br/><br/>model = Sequential()<br/><br/>model.add(Conv2D(64, (3, 3),padding = 'same', activation='relu', input_shape=(75, 75, 3)))<br/>model.add(BatchNormalization())<br/>model.add(Conv2D(64, (3, 3),padding = 'same', activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(MaxPooling2D(pool_size=(2, 2)))<br/>model.add(Dropout(0.25))<br/><br/>model.add(Conv2D(128, (3, 3),padding = 'same', activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(Conv2D(128, (3, 3),padding = 'same', activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(MaxPooling2D(pool_size=(2, 2)))<br/>model.add(Dropout(0.25))<br/><br/>model.add(Conv2D(255, (3, 3),padding = 'same', activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(Conv2D(255, (3, 3),padding = 'same', activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(Conv2D(255, (3, 3),padding = 'same', activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(MaxPooling2D(pool_size=(2, 2)))<br/>model.add(Dropout(0.25))<br/><br/>model.add(Conv2D(512, (3, 3),padding = 'same', activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(Conv2D(512, (3, 3),padding = 'same', activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(Conv2D(512, (3, 3),padding = 'same', activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(MaxPooling2D(pool_size=(2, 2)))<br/>model.add(Dropout(0.25))<br/><br/>model.add(Flatten())<br/>model.add(Dense(512, activation='relu'))<br/>model.add(BatchNormalization())<br/>model.add(Dropout(0.50))<br/>model.add(Dense(1, activation='sigmoid'))<br/><br/>optimiser = optimizers.Adadelta(lr=1.0, rho=0.95, epsilon=None, decay=0.0)<br/>model.compile(loss='binary_crossentropy', optimizer=optimiser, metrics=['accuracy'])<br/><br/>model.summary()</code></pre>
									<p><img src = "images/CNN_chien_chat_model.png"></p>
									<p><img src = "images/CNN_chien_chat_model2.png"></p>

									<h3>Entraînement du modèle</h3>
									<p>Nous avons mis en place une sauvegarde automatique des paramètres du modèle après chaques epoch.</p>
									<pre><code class="{python} language-{python}">from keras.callbacks import ModelCheckpoint<br/>checkpointer = ModelCheckpoint(filepath='/Dogs_vs_Cats/weights.hdf5', verbose=1, save_best_only=True)</code></pre>

									<p>Entraînement du modèle</p>
									<pre><code class="{python} language-{python}">model.fit(x_train,<br/>          y_train,<br/>          batch_size=100,<br/>          epochs=10,<br/>          validation_data=(x_valid, y_valid),<br/>          callbacks=[checkpointer])</code></pre>
									<p><img src = "images/CNN_chien_chat_train1.png"></p>
									<p><img src = "images/CNN_chien_chat_train2.png"></p>
									<!-- <p><img src = "images/CNN_chien_chat_train3.png"></p> -->
									<!-- <p><img src = "images/CNN_chien_chat_train4.png"></p> -->
									<p>Maintenant que notre modèle est entraîné, nous allons vérifier les performances sur l'échantillon de validation</p>
									<pre><code class="{python} language-{python}">model.load_weights('/content/gdrive/My Drive/data_google_colab/Dogs_vs_Cats/weights_2.hdf5')<br/>model.evaluate(x=x_valid, y=y_valid, batch_size=200)</code></pre>
									<p><img src = "images/CNN_chien_chat_eval.png"></p>
									<p>Nous obtenons donc sur l'échantillon de validation une accuracy de 96,12% et une loss de 0,1346</p>

									<h1>Echantillon de test</h1>
									<p>Nous allons maintennat appliquer le modèle sur l'échantillon de test. Nous allons d'abord importer les images de test de la même manière que pour les images d'entrainement.</p>
									<pre><code class="{python} language-{python}">!unzip '/content/gdrive/My Drive/data_google_colab/Dogs_vs_Cats/test.zip'<br/><br/>files = os.listdir("/content/test/")<br/><br/>features = []<br/><br/>for file in files:<br/>    features.append(np.array(Image.open("/content/train/" + file).resize((75, 75))))<br/><br/>features = np.array(features)<br/><br/>print("features :", features.shape)</code></pre>
									<p><img src = "images/CNN_chien_chat_shape_test.png"></p>

									<h1>Visualisation des résultats</h1>
									<pre><code class="{python} language-{python}">index = np.arange(len(features))<br/>np.random.shuffle(index)<br/>features = features[index]<br/><br/>predict = model.predict(features[:25], batch_size=200)</code></pre>
									<p>Nous allons appliquer le modèle sur un échantillon de 25 images issues de l'échantillon de test.</p>
									<p>Visualisation des résultats</p>
									<pre><code class="{python} language-{python}">fig = plt.figure(figsize=(17,17))<br/>plt.gcf().subplots_adjust( wspace = 0, hspace = 0.2)<br/>for i in range(1,26):<br/>    plt.subplot(5, 5, i)<br/>    img = plt.imshow(features[i])<br/>    img.axes.get_xaxis().set_visible(False)<br/>    img.axes.get_yaxis().set_visible(False)<br/>    if predict[i]&gt;=0.5:<br/>       label = "Ceci est un chat à :" + str(round(predict[i][0]*100)) + "%"<br/>    else:<br/>       label = "Ceci est un chien à :" + str(round((1-predict[i][0])*100)) + "%"<br/>    plt.title(label)<br/>plt.show()</code></pre>
									<p><img src = "images/CNN_chien_chat_result1.png"></p>
									<p><img src = "images/CNN_chien_chat_result2.png"></p>
									
									
									
									
									
									
								</section>	
									
									
									
									
									
									
									



						</div>
					</div>

				<!-- Sidebar -->
					<div id="sidebar">
						<div class="inner">

							<!-- Menu -->
								<nav id="menu">
									<header class="major">
										<h2>Menu</h2>
									</header>
									<ul>
										<li>
											<span class="opener">Pyhton</span>
											<ul>
												<li><a href="Python_collecte.html">Collecte des données</a></li>
												<li><a href="Python_manipulation.html">Manipuation de données</a></li>
												<li><a href="Python_visualisation.html">Visualisation</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">R</span>
											<ul>
												<li><a href="R_collecte.html">Collecte des données</a></li>
												<li><a href="R_manipulation.html">Manipuation de données</a></li>
												<li><a href="R_visualisation.html">Visualisation</a></li>
											</ul>
										</li>
										<li>
											<span class="opener">Projet Python</span>
											<ul>
												<li><a href="CNN_chien_chat.html">CNN - Classification chiens chats </a></li>
												<li><a href="CNN_MNIST.html">CNN - MNIST </a></li>
												<li><a href="NLP_election.html">NLP - Election présidentielle</a></li>
												<li><a href="CNN_Cancer_detection.html">CNN - Detection du cancer </a></li>
												<li><a href="CNN_Quick_draw.html">CNN - Quick Draw </a></li>
											</ul>
										</li>
									</ul>
								</nav>

							<!-- Section -->
								<section>
									<header class="major">
										<h2>Contact</h2>
									</header>
									<ul class="contact">
										<li class="icon solid fa-envelope"><a href="#">hugo.fromont35@gmail.com</a></li>
										<li class="icon brands fa-linkedin"><a href="https://www.linkedin.com/in/hugo-fromont/">Linkedin</a></li>
										<li class="icon brands fa-github"><a href="https://github.com/HugoFromont">Github</a></li>
									</ul>
								</section>
								
							<!-- Footer -->
								<footer id="footer">
									<p class="copyright">&copy; Untitled. All rights reserved. Demo Images: <a href="https://unsplash.com">Unsplash</a>. Design: <a href="https://html5up.net">HTML5 UP</a>.</p>
								</footer>


						</div>
					</div>

			</div>

		<!-- Scripts -->
			<script src="assets/js/jquery.min.js"></script>
			<script src="assets/js/browser.min.js"></script>
			<script src="assets/js/breakpoints.min.js"></script>
			<script src="assets/js/util.js"></script>
			<script src="assets/js/main.js"></script>

	</body>
</html>